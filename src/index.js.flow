// @flow
// https://flowtype.org/docs/builtins.html#mixed
type JSONObject = { [key: string]: JSON };
type JSONArray = Array<JSON>;
type JSON = string | number | boolean | null | JSONObject | JSONArray;
// type BaseOptions extends RequestOptions ... :(
// TODO: https://github.com/facebook/flow/issues/396
// https://github.com/facebook/flow/blob/2278be3ffbc2f5ebb965e91f83fc8d957fc7d779/lib/bom.js#L819
export type JsonFetchOptions = {
  body?: JSON,
  cache?: ?CacheType,
  credentials?: ?CredentialsType,
  headers?: ?HeadersInit,
  integrity?: ?string,
  method?: ?MethodType,
  mode?: ?ModeType,
  redirect?: ?RedirectType,
  referrer?: ?string,
  referrerPolicy?: ?ReferrerPolicyType,
  shouldRetry?: (responseOrError: Response | Error) => boolean,
  retry?: Object,
  expectedStatuses?: Array<number>,
}

export type JsonFetchResponse = {
  status: number,
  statusText: string,
  headers: Headers,
  text: string,
  body: JSON,
}

declare function jsonFetch (requestUrl: string, requestOptions: ?JsonFetchOptions): Promise<JsonFetchResponse>;
declare var retriers: {
  is5xx (response: Response | Error): boolean;
  isNetworkError (response: Response | Error): boolean;
};

declare export var retriers: typeof retriers;
declare export default typeof jsonFetch;
